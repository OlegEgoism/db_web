{% extends 'base.html' %}
<title>{% block title %}Таблицы в {{ db_name }}{% endblock %}</title>

{% block content %}
    <div class="welcome-container">
    <div class="title-with-button" style="display: flex; align-items: center; justify-content: space-between;">
        <h2 class="welcome-title">Список таблиц в базе данных: {{ db_name }} ({{ tables|length }} шт.)</h2>
    </div>
    <hr>

    <!-- Вывод сообщений -->
    {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <div class="alert {% if message.tags == 'success' %}alert-success{% elif message.tags == 'warning' %}alert-warning{% else %}alert-error{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Поле поиска -->
    <input type="text" id="tableSearch" class="group-search" onkeyup="filterTables()" placeholder="Поиск таблицы..."/>

    <div id="tableList">
        {% for table in tables %}
            <div class="group-item">
                <div class="group-number">
                    <strong>{{ forloop.counter }}.</strong>
                </div>
                <div class="group-name">
                    <span class="group-link-user">{{ table }}</span>
                </div>
            </div>
        {% empty %}
            <li>Нет доступных таблиц</li>
        {% endfor %}
    </div>
    <div class="all-btn">
        <a href="{% url 'database_list' %}" class="btn btn-cancel">Назад</a>
    </div>

    <script>
        function filterTables() {
            let input = document.getElementById("tableSearch");
            let filter = input.value.toLowerCase();
            let items = document.querySelectorAll(".group-item");
            items.forEach(item => {
                let tableName = item.querySelector(".group-name").innerText.trim().toLowerCase();
                if (tableName.includes(filter)) {
                    item.style.display = "";
                } else {
                    item.style.display = "none";
                }
            });
        }
    </script>
{% endblock %}
